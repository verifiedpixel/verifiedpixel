<div class="vpp preview-layout" ng-class="{closed: !selected.preview && !selected.fetch}" ng-init="extras={view: view, activity: {type: spike ? 'spike' : type, action: 'list'}, api: api}">
    <div class="list-pane {{ view || 'mgrid' }}-view">
        <header class="search-page-header">
            <div class="fitler-trigger" ng-click="flags.facets = true" ng-class="{hidden: flags.facets}"><i class="icon-filter-large"></i></div>

            <div vp-item-sortbar></div>

            <div vp-item-searchbar data-repo="repo" data-context="context" class="searchbar-flex-handler"></div>
        
            <div sd-pagination data-items="items"></div>

            <div class="view-select">
                <button tooltip="{{ :: 'switch to grid view' | translate }}" tooltip-placement="left"  ng-show="view !== 'mgrid'" ng-click="setview('mgrid')"><i class="icon-th"></i></button>
                <button tooltip="{{ :: 'switch to list view' | translate }}" tooltip-placement="left"  ng-show="view !== 'compact'" ng-click="setview('compact')"><i class="icon-th-list"></i></button>
            </div>

            <div vp-multi-action-bar></div>
        </header>


        <div class="content" sd-updown data-items="items._items" data-select="preview(item)">
            <div class="loading-indicator" ng-show="loading" translate>loading</div>

            <div vp-search-tags></div>

            <div ng-if="selected.preview">
              <div sd-shadow>

                <div class="thumbs">
                    <nav ng-if="view !== 'compact'">
                        <span class="prev">Previous</span>
                        <span class="next">Next</span>
                    </nav>
                    <div ng-if="view !== 'compact'" class="filmstrip">
                        <ul class="slides">
                            <li ng-repeat="item in items._items" class="list-item-view" ng-class="{active: item === selected.preview || item._id === selected.fetch}">
                                <div vp-media-box></div>
                            </li>
                        </ul>
                    </div>
                    <ul ng-if="view == 'compact'">
                        <li ng-repeat="item in items._items" class="list-item-view" ng-class="{active: item === selected.preview || item._id === selected.fetch}">
                            <div vp-media-box></div>
                        </li>
                    </ul>
                </div>
              </div>
              <div class="preview-container" ng-if="view !== 'compact'">
                  <img ng-src="{{ selected.preview.renditions.viewImage.href }}" />
                  <p></p>
              </div>
            </div>

            <div ng-if="!selected.preview">
              <div sd-shadow>
                  <ul class="{{view}}-view list-view">
                      <li ng-repeat="item in items._items" class="list-item-view" ng-class="{active: item === selected.preview || item._id === selected.fetch}">
                          <div vp-media-box></div>
                      </li>
                  </ul>
              </div>
            </div>

        </div>
    </div>

    <div vp-item-preview
        data-item="selected.preview"
        data-close="preview()"
        data-open-lightbox="openLightbox"
        data-open-single-item="openSingleItem"
        ></div>

    <div class="preview-pane content-item-preview"
        sd-send-item
        ng-show="selected.fetch"
        data-item="selected.fetch"
        data-mode="{{type}}"></div>
</div>
